explain analyze 
select clerk, orderkey from orders where orderdate in (select receiptdate from lineitem where quantity > 40);



explain analyze 
select orders.clerk, orders.orderkey, lineitem.quantity as quantity 
from orders left join lineitem 
on orders.orderdate = lineitem.receiptdate and day(lineitem.receiptdate) <> 31 
order by quantity nulls first 
limit 10;

                                                                                                                                                         Query Plan                                                                                                                                                          
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Fragment 1 [SINGLE]                                                                                                                                                                                                                                                                                                         
     CPU: 2.43ms, Scheduled: 5.82ms, Input: 80 rows (2.34kB); per task: avg.: 80.00 std.dev.: 0.00, Output: 10 rows (299B), 1 tasks                                                                                                                                                                                          
     Output layout: [orderkey, clerk, quantity]                                                                                                                                                                                                                                                                              
     Output partitioning: SINGLE []                                                                                                                                                                                                                                                                                          
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                                                                           
     - TopN[PlanNodeId 428][10 by (quantity ASC_NULLS_FIRST)] => [orderkey:bigint, clerk:varchar(15), quantity:double]                                                                                                                                                                                                       
             CPU: 0.00ns (0.00%), Scheduled: 3.00ms (0.40%), Output: 10 rows (299B)                                                                                                                                                                                                                                          
             Input avg.: 80.00 rows, Input std.dev.: 0.00%                                                                                                                                                                                                                                                                   
         - LocalExchange[PlanNodeId 538][SINGLE] () => [orderkey:bigint, clerk:varchar(15), quantity:double]                                                                                                                                                                                                                 
                 CPU: 0.00ns (0.00%), Scheduled: 0.00ns (0.00%), Output: 80 rows (2.34kB)                                                                                                                                                                                                                                    
                 Input avg.: 20.00 rows, Input std.dev.: 0.00%                                                                                                                                                                                                                                                               
             - RemoteSource[2] => [orderkey:bigint, clerk:varchar(15), quantity:double]                                                                                                                                                                                                                                      
                     CPU: 0.00ns (0.00%), Scheduled: 1.00ms (0.13%), Output: 80 rows (2.34kB)                                                                                                                                                                                                                                
                     Input avg.: 20.00 rows, Input std.dev.: 0.00%                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                             
 Fragment 2 [tpch:orders:15000]                                                                                                                                                                                                                                                                                              
     CPU: 324.91ms, Scheduled: 535.56ms, Input: 74,023 rows (1.29MB); per task: avg.: 74,023.00 std.dev.: 0.00, Output: 80 rows (2.34kB), 1 tasks                                                                                                                                                                            
     Output layout: [orderkey, clerk, quantity]                                                                                                                                                                                                                                                                              
     Output partitioning: SINGLE []                                                                                                                                                                                                                                                                                          
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                                                                           
     - TopNPartial[PlanNodeId 427][10 by (quantity ASC_NULLS_FIRST)] => [orderkey:bigint, clerk:varchar(15), quantity:double]                                                                                                                                                                                                
             CPU: 26.00ms (5.66%), Scheduled: 35.00ms (4.65%), Output: 80 rows (2.34kB)                                                                                                                                                                                                                                      
             Input avg.: 44,492.13 rows, Input std.dev.: 0.58%                                                                                                                                                                                                                                                               
         - LeftJoin[PlanNodeId 5][("orderdate" = "receiptdate")][$hashvalue, $hashvalue_14] => [orderkey:bigint, clerk:varchar(15), quantity:double]                                                                                                                                                                         
                 CPU: 37.00ms (8.06%), Scheduled: 59.00ms (7.84%), Output: 355,937 rows (6.19MB)                                                                                                                                                                                                                             
                 Left (probe) Input avg.: 1,875.00 rows, Input std.dev.: 0.00%                                                                                                                                                                                                                                               
                 Right (build) Input avg.: 14,755.75 rows, Input std.dev.: 1.99%                                                                                                                                                                                                                                             
                         Collisions avg.: 134.73 (2.22% est.), Collisions std.dev.: 59.44%                                                                                                                                                                                                                                   
                 Distribution: REPLICATED                                                                                                                                                                                                                                                                                    
             - ScanProject[PlanNodeId 0,592][table = TableHandle {connectorId='tpch', connectorHandle='orders:sf0.01', layout='Optional[orders:sf0.01]'}, grouped = false, projectLocality = LOCAL] => [orderkey:bigint, orderdate:date, clerk:varchar(15), $hashvalue:bigint]                                               
                     Estimates: {source: CostBasedSourceInfo, rows: 15,000 (556.64kB), cpu: 510,000.00, memory: 0.00, network: 0.00}/{source: CostBasedSourceInfo, rows: 15,000 (556.64kB), cpu: 1,155,000.00, memory: 0.00, network: 0.00}                                                                                  
                     CPU: 257.00ms (55.99%), Scheduled: 428.00ms (56.84%), Output: 15,000 rows (629.88kB)                                                                                                                                                                                                                    
                     Input avg.: 1,875.00 rows, Input std.dev.: 0.00%                                                                                                                                                                                                                                                        
                     $hashvalue := combine_hash(BIGINT'0', COALESCE($operator$hash_code(orderdate), BIGINT'0')) (1:119)                                                                                                                                                                                                      
                     orderkey := tpch:orderkey (1:90)                                                                                                                                                                                                                                                                        
                     orderdate := tpch:orderdate (1:90)                                                                                                                                                                                                                                                                      
                     clerk := tpch:clerk (1:90)                                                                                                                                                                                                                                                                              
                     tpch:orderstatus                                                                                                                                                                                                                                                                                        
                         :: [["F"], ["O"], ["P"]]                                                                                                                                                                                                                                                                            
                     Input: 15,000 rows (0B), Filtered: 0.00%                                                                                                                                                                                                                                                                
             - LocalExchange[PlanNodeId 537][HASH][$hashvalue_14] (receiptdate) => [quantity:double, receiptdate:date, $hashvalue_14:bigint]                                                                                                                                                                                 
                     Estimates: {source: CostBasedSourceInfo, rows: ? (?), cpu: ?, memory: 0.00, network: ?}                                                                                                                                                                                                                 
                     CPU: 3.00ms (0.65%), Scheduled: 8.00ms (1.06%), Output: 59,023 rows (1.29MB)                                                                                                                                                                                                                            
                     Input avg.: 14,755.75 rows, Input std.dev.: 100.00%                                                                                                                                                                                                                                                     
                 - RemoteSource[3] => [quantity:double, receiptdate:date, $hashvalue_15:bigint]                                                                                                                                                                                                                              
                         CPU: 1.00ms (0.22%), Scheduled: 2.00ms (0.27%), Output: 59,023 rows (1.29MB)                                                                                                                                                                                                                        
                         Input avg.: 14,755.75 rows, Input std.dev.: 100.00%                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                                                                             
 Fragment 3 [tpch:orders:15000]                                                                                                                                                                                                                                                                                              
     CPU: 136.25ms, Scheduled: 220.83ms, Input: 60,175 rows (0B); per task: avg.: 60,175.00 std.dev.: 0.00, Output: 59,023 rows (1.29MB), 1 tasks                                                                                                                                                                            
     Output layout: [quantity, receiptdate, $hashvalue_16]                                                                                                                                                                                                                                                                   
     Output partitioning: BROADCAST []                                                                                                                                                                                                                                                                                       
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                                                                           
     - ScanFilterProject[PlanNodeId 1,482,593][table = TableHandle {connectorId='tpch', connectorHandle='lineitem:sf0.01', layout='Optional[lineitem:sf0.01]'}, grouped = false, filterPredicate = (day(receiptdate)) <> (BIGINT'31'), projectLocality = LOCAL] => [quantity:double, receiptdate:date, $hashvalue_16:bigint] 
             Estimates: {source: CostBasedSourceInfo, rows: 60,175 (1.32MB), cpu: 842,450.00, memory: 0.00, network: 0.00}/{source: CostBasedSourceInfo, rows: ? (?), cpu: 1,684,900.00, memory: 0.00, network: 0.00}/{source: CostBasedSourceInfo, rows: ? (?), cpu: ?, memory: 0.00, network: 0.00}                        
             CPU: 135.00ms (29.41%), Scheduled: 217.00ms (28.82%), Output: 59,023 rows (1.29MB)                                                                                                                                                                                                                              
             Input avg.: 7,521.88 rows, Input std.dev.: 0.52%                                                                                                                                                                                                                                                                
             $hashvalue_16 := combine_hash(BIGINT'0', COALESCE($operator$hash_code(receiptdate), BIGINT'0')) (1:107)                                                                                                                                                                                                         
             receiptdate := tpch:receiptdate (1:107)                                                                                                                                                                                                                                                                         
             quantity := tpch:quantity (1:107)                                                                                                                                                                                                                                                                               
             Input: 60,175 rows (0B), Filtered: 1.91%                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                                                                             
(1 row)
