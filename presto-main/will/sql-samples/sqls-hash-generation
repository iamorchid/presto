select orderpriority, count(orderkey) from orders group by orderpriority;

                                                                                                                               Query Plan                                                                                                                                
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 - Output[PlanNodeId 8][orderpriority, _col1] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                               
         _col1 := count (1:31)                                                                                                                                                                                                                                           
     - RemoteStreamingExchange[PlanNodeId 185][GATHER] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                      
         - Project[PlanNodeId 251][projectLocality = LOCAL] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                 
             - Aggregate(FINAL)[orderpriority][$hashvalue][PlanNodeId 3] => [orderpriority:varchar(15), $hashvalue:bigint, count:bigint]                                                                                                                                 
                     count := "presto.default.count"((count_9)) (1:31)                                                                                                                                                                                                   
                 - LocalExchange[PlanNodeId 218][HASH][$hashvalue] (orderpriority) => [orderpriority:varchar(15), count_9:bigint, $hashvalue:bigint]                                                                                                                     
                     - RemoteStreamingExchange[PlanNodeId 224][REPARTITION][$hashvalue_10] => [orderpriority:varchar(15), count_9:bigint, $hashvalue_10:bigint]                                                                                                          
                         - Aggregate(PARTIAL)[orderpriority][$hashvalue_11][PlanNodeId 222] => [orderpriority:varchar(15), $hashvalue_11:bigint, count_9:bigint]                                                                                                         
                                 count_9 := "presto.default.count"((orderkey)) (1:31)                                                                                                                                                                                    
                             - ScanProject[PlanNodeId 0,250][table = TableHandle {connectorId='tpch', connectorHandle='orders:sf0.01', layout='Optional[orders:sf0.01]'}, projectLocality = LOCAL] => [orderkey:bigint, orderpriority:varchar(15), $hashvalue_11:bigint] 
                                     Estimates: {source: CostBasedSourceInfo, rows: 15,000 (328.31kB), cpu: 336,188.00, memory: 0.00, network: 0.00}/{source: CostBasedSourceInfo, rows: 15,000 (328.31kB), cpu: 807,376.00, memory: 0.00, network: 0.00}                
                                     $hashvalue_11 := combine_hash(BIGINT'0', COALESCE($operator$hash_code(orderpriority), BIGINT'0')) (1:68)                                                                                                                            
                                     orderpriority := tpch:orderpriority (1:52)                                                                                                                                                                                          
                                     orderkey := tpch:orderkey (1:52)                                                                                                                                                                                                    
                                     tpch:orderstatus                                                                                                                                                                                                                    
                                         :: [["F"], ["O"], ["P"]]                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
(1 row)


                                                                                                                              Query Plan                                                                                                                              
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Fragment 0 [SINGLE]                                                                                                                                                                                                                                                  
     Output layout: [orderpriority, count]                                                                                                                                                                                                                            
     Output partitioning: SINGLE []                                                                                                                                                                                                                                   
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                    
     - Output[PlanNodeId 8][orderpriority, _col1] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                        
             _col1 := count (1:50)                                                                                                                                                                                                                                    
         - RemoteSource[1] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                                               
                                                                                                                                                                                                                                                                      
 Fragment 1 [HASH]                                                                                                                                                                                                                                                    
     Output layout: [orderpriority, count]                                                                                                                                                                                                                            
     Output partitioning: SINGLE []                                                                                                                                                                                                                                   
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                    
     - Project[PlanNodeId 251][projectLocality = LOCAL] => [orderpriority:varchar(15), count:bigint]                                                                                                                                                                  
         - Aggregate(FINAL)[orderpriority][$hashvalue][PlanNodeId 3] => [orderpriority:varchar(15), $hashvalue:bigint, count:bigint]                                                                                                                                  
                 count := "presto.default.count"((count_9)) (1:50)                                                                                                                                                                                                    
             - LocalExchange[PlanNodeId 218][HASH][$hashvalue] (orderpriority) => [orderpriority:varchar(15), count_9:bigint, $hashvalue:bigint]                                                                                                                      
                 - RemoteSource[2] => [orderpriority:varchar(15), count_9:bigint, $hashvalue_10:bigint]                                                                                                                                                               
                                                                                                                                                                                                                                                                      
 Fragment 2 [tpch:orders:15000]                                                                                                                                                                                                                                       
     Output layout: [orderpriority, count_9, $hashvalue_11]                                                                                                                                                                                                           
     Output partitioning: HASH [orderpriority][$hashvalue_11]                                                                                                                                                                                                         
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                                    
     - Aggregate(PARTIAL)[orderpriority][$hashvalue_11][PlanNodeId 222] => [orderpriority:varchar(15), $hashvalue_11:bigint, count_9:bigint]                                                                                                                          
             count_9 := "presto.default.count"((orderkey)) (1:50)                                                                                                                                                                                                     
         - ScanProject[PlanNodeId 0,250][table = TableHandle {connectorId='tpch', connectorHandle='orders:sf0.01', layout='Optional[orders:sf0.01]'}, grouped = false, projectLocality = LOCAL] => [orderkey:bigint, orderpriority:varchar(15), $hashvalue_11:bigint] 
                 Estimates: {source: CostBasedSourceInfo, rows: 15,000 (460.14kB), cpu: 336,188.00, memory: 0.00, network: 0.00}/{source: CostBasedSourceInfo, rows: 15,000 (460.14kB), cpu: 807,376.00, memory: 0.00, network: 0.00}                                 
                 $hashvalue_11 := combine_hash(BIGINT'0', COALESCE($operator$hash_code(orderpriority), BIGINT'0')) (1:87)                                                                                                                                             
                 orderpriority := tpch:orderpriority (1:71)                                                                                                                                                                                                           
                 orderkey := tpch:orderkey (1:71)                                                                                                                                                                                                                     
                 tpch:orderstatus                                                                                                                                                                                                                                     
                     :: [["F"], ["O"], ["P"]]                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                      
(1 row)

