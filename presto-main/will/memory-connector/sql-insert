
presto> explain (type distributed) INSERT INTO memory.tiny."bucketed-orders" (SELECT * FROM tpch.tiny.orders);
                                                                                                                                                                                                                                                             >
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
 Fragment 0 [COORDINATOR_ONLY]                                                                                                                                                                                                                               >
     Output layout: [rows_62]                                                                                                                                                                                                                                >
     Output partitioning: SINGLE []                                                                                                                                                                                                                          >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - Output[PlanNodeId 10][rows] => [rows_62:bigint]                                                                                                                                                                                                       >
             rows := rows_62                                                                                                                                                                                                                                 >
         - TableCommit[PlanNodeId 8][Optional[TableHandle {connectorId='memory', connectorHandle='MemoryTableHandle{connectorId=memory, schemaName=tiny, tableName=bucketed-orders, tableId=0, columnHandles=[MemoryColumnHandle{name=orderkey, columnType=bi>
             - RemoteSource[1] => [rows:bigint, fragments:varbinary, commitcontext:varbinary]                                                                                                                                                                >
                                                                                                                                                                                                                                                             >
 Fragment 1 [memory:com.facebook.presto.plugin.memory.MemoryPartitioningHandle@7087eb36]                                                                                                                                                                     >
     Output layout: [rows, fragments, commitcontext]                                                                                                                                                                                                         >
     Output partitioning: SINGLE []                                                                                                                                                                                                                          >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - TableWriter[PlanNodeId 9] => [rows:bigint, fragments:varbinary, commitcontext:varbinary]                                                                                                                                                              >
             orderkey := orderkey (1:70)                                                                                                                                                                                                                     >
             custkey := custkey (1:70)                                                                                                                                                                                                                       >
             orderstatus := orderstatus (1:70)                                                                                                                                                                                                               >
             totalprice := totalprice (1:70)                                                                                                                                                                                                                 >
             orderdate := orderdate (1:70)                                                                                                                                                                                                                   >
             orderpriority := orderpriority (1:70)                                                                                                                                                                                                           >
             clerk := clerk (1:70)                                                                                                                                                                                                                           >
             shippriority := shippriority (1:70)                                                                                                                                                                                                             >
             comment := comment (1:70)                                                                                                                                                                                                                       >
             Statistics collected: 0                                                                                                                                                                                                                         >
         - LocalExchange[PlanNodeId 242][SINGLE] () => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpriority:varchar(15), clerk:varchar(15), shippriority:integer, comment:varchar(79)]                 >
                 Estimates: {source: CostBasedSourceInfo, rows: 15000 (1.70MB), cpu: 3897104.00, memory: 0.00, network: 1948552.00}                                                                                                                          >
             - RemoteSource[2] => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpriority:varchar(15), clerk:varchar(15), shippriority:integer, comment:varchar(79)]                                      >
                                                                                                                                                                                                                                                             >
 Fragment 2 [tpch:orders:15000]                                                                                                                                                                                                                              >
     Output layout: [orderkey, custkey, orderstatus, totalprice, orderdate, orderpriority, clerk, shippriority, comment]                                                                                                                                     >
     /**
      * 可以看到，在进行数据插入之前，这里的数据按照target table预期的partitioning进行处理。
      */
     Output partitioning: memory:com.facebook.presto.plugin.memory.MemoryPartitioningHandle@7087eb36 [orderkey]                                                                                                                                              >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - TableScan[PlanNodeId 0][TableHandle {connectorId='tpch', connectorHandle='orders:sf0.01', layout='Optional[orders:sf0.01]'}, grouped = false] => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpri>
             Estimates: {source: CostBasedSourceInfo, rows: 15000 (1.86MB), cpu: 1948552.00, memory: 0.00, network: 0.00}                                                                                                                                    >
             orderpriority := tpch:orderpriority (1:85)                                                                                                                                                                                                      >
             custkey := tpch:custkey (1:85)                                                                                                                                                                                                                  >
             shippriority := tpch:shippriority (1:85)                                                                                                                                                                                                        >
             orderstatus := tpch:orderstatus (1:85)                                                                                                                                                                                                          >
                 :: [["F"], ["O"], ["P"]]                                                                                                                                                                                                                    >
             orderdate := tpch:orderdate (1:85)                                                                                                                                                                                                              >
             comment := tpch:comment (1:85)                                                                                                                                                                                                                  >
             orderkey := tpch:orderkey (1:85)                                                                                                                                                                                                                >
             clerk := tpch:clerk (1:85)                                                                                                                                                                                                                      >
             totalprice := tpch:totalprice (1:85)                                                                                                                                                                                                            >
                                                                                                                                                                                                                                                             >
                                                                                                                                                                                                                                                             >
(1 row)

presto> explain (type distributed) INSERT INTO memory.tiny."orders" (SELECT * FROM tpch.tiny.orders);
                                                                                                                                                                                                                                                             >
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
 Fragment 0 [COORDINATOR_ONLY]                                                                                                                                                                                                                               >
     Output layout: [rows_62]                                                                                                                                                                                                                                >
     Output partitioning: SINGLE []                                                                                                                                                                                                                          >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - Output[PlanNodeId 10][rows] => [rows_62:bigint]                                                                                                                                                                                                       >
             rows := rows_62                                                                                                                                                                                                                                 >
         - TableCommit[PlanNodeId 8][Optional[TableHandle {connectorId='memory', connectorHandle='MemoryTableHandle{connectorId=memory, schemaName=tiny, tableName=orders, tableId=1, columnHandles=[MemoryColumnHandle{name=orderkey, columnType=bigint, col>
             - RemoteSource[1] => [rows:bigint, fragments:varbinary, commitcontext:varbinary]                                                                                                                                                                >
                                                                                                                                                                                                                                                             >
 Fragment 1 [ROUND_ROBIN]                                                                                                                                                                                                                                    >
     Output layout: [rows, fragments, commitcontext]                                                                                                                                                                                                         >
     Output partitioning: SINGLE []                                                                                                                                                                                                                          >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - TableWriter[PlanNodeId 9] => [rows:bigint, fragments:varbinary, commitcontext:varbinary]                                                                                                                                                              >
             orderkey := orderkey (1:61)                                                                                                                                                                                                                     >
             custkey := custkey (1:61)                                                                                                                                                                                                                       >
             orderstatus := orderstatus (1:61)                                                                                                                                                                                                               >
             totalprice := totalprice (1:61)                                                                                                                                                                                                                 >
             orderdate := orderdate (1:61)                                                                                                                                                                                                                   >
             orderpriority := orderpriority (1:61)                                                                                                                                                                                                           >
             clerk := clerk (1:61)                                                                                                                                                                                                                           >
             shippriority := shippriority (1:61)                                                                                                                                                                                                             >
             comment := comment (1:61)                                                                                                                                                                                                                       >
             Statistics collected: 0                                                                                                                                                                                                                         >
         - LocalExchange[PlanNodeId 242][SINGLE] () => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpriority:varchar(15), clerk:varchar(15), shippriority:integer, comment:varchar(79)]                 >
                 Estimates: {source: CostBasedSourceInfo, rows: 15000 (1.70MB), cpu: 3897104.00, memory: 0.00, network: 1948552.00}                                                                                                                          >
             - RemoteSource[2] => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpriority:varchar(15), clerk:varchar(15), shippriority:integer, comment:varchar(79)]                                      >
                                                                                                                                                                                                                                                             >
 Fragment 2 [tpch:orders:15000]                                                                                                                                                                                                                              >
     Output layout: [orderkey, custkey, orderstatus, totalprice, orderdate, orderpriority, clerk, shippriority, comment]                                                                                                                                     >
     Output partitioning: ROUND_ROBIN []                                                                                                                                                                                                                     >
     Stage Execution Strategy: UNGROUPED_EXECUTION                                                                                                                                                                                                           >
     - TableScan[PlanNodeId 0][TableHandle {connectorId='tpch', connectorHandle='orders:sf0.01', layout='Optional[orders:sf0.01]'}, grouped = false] => [orderkey:bigint, custkey:bigint, orderstatus:varchar(1), totalprice:double, orderdate:date, orderpri>
             Estimates: {source: CostBasedSourceInfo, rows: 15000 (1.86MB), cpu: 1948552.00, memory: 0.00, network: 0.00}                                                                                                                                    >
             orderpriority := tpch:orderpriority (1:76)                                                                                                                                                                                                      >
             custkey := tpch:custkey (1:76)                                                                                                                                                                                                                  >
             shippriority := tpch:shippriority (1:76)                                                                                                                                                                                                        >
             orderstatus := tpch:orderstatus (1:76)                                                                                                                                                                                                          >
                 :: [["F"], ["O"], ["P"]]                                                                                                                                                                                                                    >
             orderdate := tpch:orderdate (1:76)                                                                                                                                                                                                              >
             comment := tpch:comment (1:76)                                                                                                                                                                                                                  >
             orderkey := tpch:orderkey (1:76)                                                                                                                                                                                                                >
             clerk := tpch:clerk (1:76)                                                                                                                                                                                                                      >
             totalprice := tpch:totalprice (1:76)
